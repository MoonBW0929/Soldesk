<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>h4_open_weather_map</title>
        <script src="jQuery.js"></script>
        <script>

            var temp;
            var humi;
            var weather;
            var icon;

            var appid = "baff8f3c6cbc28a4024e336599de28c4";
            var units = "metric";
            var lang = "kr";
            
            $(function (){
                
                navigator.geolocation.getCurrentPosition(function (pos){
                    
                    var lat = pos.coords.latitude;
                    var lon = pos.coords.longitude;
                    var url = "https://api.openweathermap.org/data/2.5/weather?lat="+lat+"&lon="+lon+"&appid="+appid+"&units="+units+"&lang="+lang;
                    
                    $("html").mousemove(function (evt){
    
                        $.getJSON(url, function(asd){
        
                            temp = asd.main.temp;
                            humi = asd.main.humidity;
                            weather = asd.weather[0].description;
                            icon = asd.weather[0].icon;

                            $("#weather").text(weather);
                            $("#temp").text(temp+"˚C ");
                            $("#humi").text("("+humi+"%)");
                            $("#icon").attr("src", "https://openweathermap.org/img/wn/"+icon+"@2x.png");
                        });
                        
                        $("table").css("top", (evt.pageY+10)+"px");
                        $("table").css("left", (evt.pageX+10)+"px");

                        // $("body").empty();
                        
                        // var table = $("<table></table>").css("position", "absolute");
                        // var tr;
                        // var td1, td2, td3;
                        
                        // tr = $("<tr></tr>");
                        // td1 = $("<td></td>");
                        // td2 = $("<td></td>").text(weather);
                        // $(tr).append(td1, td2);
                        // $(table).append(tr);

                        // tr = $("<tr></tr>");
                        // td1 = $("<img>").attr("src", "https://openweathermap.org/img/wn/01d@2x.png");
                        // $(td1).css("width", "35px");
                        // $(td1).css("height", "35px");
                        // td2 = $("<td></td>").text(temp+"˚C ");
                        // td3 = $("<td></td>").text("("+humi+"%)");
                        // $(tr).append(td1, td2, td3);
                        // $(table).append(tr);

                        // $(table).css("top", (evt.pageY+10)+"px");
                        // $(table).css("left", (evt.pageX+10)+"px");
                        
                        // $("body").append(table);
                    });
                });
                
            });
        </script>
        <style>
            img{
                width: 35px;
                height: 35px;
            }
            
            table{
                position: absolute;
            }
        </style>
    </head>
    <body>
         <table>
            <tr>
                <td></td>
                <td id="weather"></td>
            </tr>
            <tr>
                <td>
                    <img id="icon">
                </td>
                <td id="temp"></td>
                <td id="humi"></td>
            </tr>
         </table>
    </body>
</html>